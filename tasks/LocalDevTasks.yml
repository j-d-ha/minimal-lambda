version: '3'

tasks:
  restore:
    desc: Restore NuGet dependencies locally
    silent: true
    cmds:
      - echo "ğŸ“¥ Restoring dependencies"
      - dotnet restore
      - echo "âœ… Dependencies restored"

  build-debug:
    desc: Build solution in Debug configuration locally
    silent: true
    cmds:
      - echo "ğŸ”¨ Building Debug configuration"
      - task: restore
      - dotnet build --configuration Debug --no-restore
      - echo "âœ… Debug build complete"

  tools:restore:
    desc: Restore and reinstall local dotnet tools
    silent: true
    cmds:
      - echo "ğŸ› ï¸ Restoring dotnet tools"
      - dotnet tool restore
      - echo "âœ… Tools restored"

  clean-all:
    desc: Clean all build artifacts and packages
    silent: true
    cmds:
      - echo "ğŸ§¹ Cleaning all build artifacts"
      - dotnet clean --configuration Release
      - dotnet clean --configuration Debug
      - echo "ğŸ—‘ï¸ Removing bin and obj directories"
      - find . -type d -name "bin" -o -name "obj" | xargs rm -rf
      - echo "âœ… Complete cleanup finished"

  test-watch:
    desc: Run tests in watch mode for TDD
    silent: true
    cmds:
      - task: test:watch

  lambda-test:
    desc: Start the AWS Lambda test tool
    silent: true
    cmds:
      - dotnet lambda-test-tool start --lambda-emulator-port 5050 --config-storage-path ./lambda_test_tool
  
  run-docs:
    desc: Run MKDocs server locally
    silent: true
    cmds:
      - uv sync
      - uv run mkdocs serve --livereload 