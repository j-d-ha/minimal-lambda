version: '3'

tasks:
  restore:
    desc: Restore NuGet dependencies
    silent: true
    cmds:
      - echo "ðŸ“¥ Restoring dependencies"
      - dotnet restore
      - echo "âœ… Dependencies restored"

  build:
    desc: Build solution in Release configuration
    silent: true
    cmds:
      - echo "ðŸ”¨ Building Release"
      - dotnet build --configuration Release --no-restore
      - echo "âœ… Release build complete"

  build-debug:
    desc: Build solution in Debug configuration
    silent: true
    cmds:
      - echo "ðŸ”¨ Building Debug"
      - dotnet build --configuration Debug --no-restore
      - echo "âœ… Debug build complete"

  clean:
    desc: Clean NuGet packages from Release folder
    silent: true
    cmds:
      - echo "ðŸ§¹ Cleaning"
      - '[ -d ./nupkg ] && rm -r ./nupkg || true'
      - echo "done with one"
      - find src -path "src/*/obj/Release/*.nuspec" -delete
      - dotnet clean --configuration Release

  pack:
    desc: Build the NuGet package
    silent: true
    cmds:
      - task: clean
      - echo "ðŸ“¦ Packing {{.DIR}}"
      - dotnet restore
      - dotnet build --configuration Release --no-restore
      - dotnet pack --configuration Release --no-build --output ./nupkg
      - echo "âœ… Packed"
